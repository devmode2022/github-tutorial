This is changes from branch 2
