this is the latest changes from branch 1